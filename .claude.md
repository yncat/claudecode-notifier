# Claude Code Notifier - 実装情報

## ビルドコマンド

```cmd
nmake all      # ビルド
nmake test     # テスト（サンプル通知を送信）
nmake clean    # クリーンアップ
```

## プロジェクト構成

```
claudecode-notifier/
├── src/
│   ├── main.cpp          - メインアプリケーションロジック
│   ├── tts_speaker.cpp   - SAPI 5.0 音声合成実装
│   ├── tts_speaker.h     - TTS スピーカーヘッダー
│   ├── json_parser.cpp   - JSON 解析ロジック
│   ├── json_parser.h     - JSON パーサーヘッダー
│   └── picojson.h        - PicoJSON ライブラリ
├── build/                - ビルド成果物
└── Makefile             - ビルド設定
```

## 技術詳細

- **言語**: Visual C++ による C++
- **音声**: Windows Speech API (SAPI) 5.0
- **JSON 解析**: PicoJSON ライブラリ使用
- **ビルドシステム**: Visual Studio コンパイラによる nmake
- **依存関係**: Windows システムライブラリ（ole32.lib、oleaut32.lib、sapi.lib）

## 入力形式

Claude Code からのJSON入力例：
```json
{
  "session_id": "test123",
  "message": "Claude is waiting for your input",
  "hook_event_name": "Notification",
  "cwd": "/path/to/directory"
}
```

## 通知メッセージパターン

- **入力待ち**: "Session [ID] is waiting for your input."
- **許可要求**: "Session [ID] needs permission to use a tool."
- **停止通知**: "Session [ID] has stopped."
- **一般通知**: "Session [ID] has a notification."

セッション ID は最初の8文字に短縮される。

## 手動テストコマンド

```cmd
echo {"session_id":"test123","message":"Claude is waiting for your input","hook_event_name":"Notification","cwd":"C:\\test"} | claudecode-notifier.exe
```

### Stopフックのテスト

```cmd
echo {"session_id":"test123","message":"Session has stopped","hook_event_name":"Stop","cwd":"C:\\test"} > test_stop.json
powershell -Command "Get-Content test_stop.json | .\claudecode-notifier.exe"
```

## ライセンス

- **PicoJSON**: BSD-2-Clause ライセンス
  - Copyright (c) 2009-2010 Cybozu Labs, Inc.
  - Copyright (c) 2011-2014 Kazuho Oku